<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>M√©moire de Cendre ‚Äî Prototype</title>
  <style>
    :root {
      --bg: #0b0c10;
      --panel: #12141a;
      --ink: #e9e9ef;
      --muted: #b9bcc8;
      --accent: #6aa7ff;
      --accent2: #ff6ab0;
      --line: rgba(255,255,255,.1);
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; margin: 0; padding: 0; }
    body {
      background: radial-gradient(1200px 700px at 20% 10%, #0f1117 0%, var(--bg) 60%);
      color: var(--ink);
      font: 16px/1.6 system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, "Helvetica Neue", Arial;
      display: grid;
      place-items: center;
      padding: 24px;
    }

    .app {
      width: min(960px, 100%);
      background: linear-gradient(180deg, rgba(255,255,255,.02), rgba(0,0,0,.08));
      backdrop-filter: blur(6px);
      border: 1px solid rgba(255,255,255,.08);
      border-radius: 18px;
      padding: 22px 20px 16px;
      box-shadow: 0 30px 120px rgba(0,0,0,.45);
    }

    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
      margin-bottom: 10px;
    }

    .title { font-weight: 800; letter-spacing: .4px; }
    .subtitle { color: var(--muted); font-size: 14px; }

    .state {
      display: flex;
      gap: 10px;
      align-items: center;
      color: var(--muted);
      font-size: 13px;
    }

    .pill {
      border: 1px solid var(--line);
      padding: 4px 10px;
      border-radius: 999px;
    }

    main {
      background: var(--panel);
      border-radius: 14px;
      padding: 18px;
      border: 1px solid var(--line);
    }

    .act { color: var(--accent); font-weight: 700; margin-bottom: 4px; }
    .scene { font-size: 22px; font-weight: 700; margin: 2px 0 8px; }

    #text, #adv { white-space: pre-wrap; margin: 8px 0 12px; }
    #adv { color: var(--accent2); font-style: italic; }

    .choices { display: grid; gap: 10px; margin-top: 6px; }

    .choices button {
      text-align: left;
      width: 100%;
      border: 1px solid var(--line);
      background: #171923;
      color: var(--ink);
      padding: 12px 14px;
      border-radius: 12px;
      cursor: pointer;
      transition: transform .06s ease, background .2s ease, border-color .2s ease;
    }

    .choices button:hover {
      background: #1c1f2c;
      border-color: rgba(255,255,255,.18);
      transform: translateY(-1px);
    }

    .toolbar {
      display: flex;
      gap: 10px;
      margin-top: 14px;
      justify-content: space-between;
      align-items: center;
    }

    .ghost {
      background: transparent;
      border: 1px solid var(--line);
      color: var(--muted);
      padding: 8px 10px;
      border-radius: 10px;
      cursor: pointer;
    }

    .primary {
      background: #223;
      color: var(--ink);
      border: 1px solid var(--line);
      padding: 8px 12px;
      border-radius: 10px;
      cursor: pointer;
    }

    .journal {
      margin-top: 14px;
      color: var(--muted);
      font-size: 14px;
      border-top: 1px dashed var(--line);
      padding-top: 10px;
      min-height: 3em;
    }

    .fade { animation: fade .28s ease both; }
    @keyframes fade { from { opacity: 0; transform: translateY(6px); } to { opacity: 1; transform: none; } }

    .footer {
      margin-top: 8px;
      color: var(--muted);
      font-size: 12px;
      display: flex;
      justify-content: space-between;
      gap: 8px;
    }

    .kbd {
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      background: #151826;
      padding: 2px 6px;
      border-radius: 6px;
      border: 1px solid var(--line);
      color: #d1d7ff;
    }
  </style>
</head>
<body>
  <div class="app">
    <header>
      <div>
        <div class="title">M√âMOIRE DE CENDRE</div>
        <div class="subtitle">Thriller int√©rieur ‚Äî mentalisme ‚Ä¢ psychanalyse ‚Ä¢ mystique symbolique</div>
      </div>
      <div class="state">
        <span class="pill" id="pill-act">Acte I</span>
        <span class="pill" id="pill-tone">Tonalit√© : ‚Äî</span>
        <button class="ghost" id="btn-restart" title="Recommencer (R)">‚Üª Recommencer</button>
      </div>
    </header>

    <main id="card" class="fade">
      <div class="act" id="act"></div>
      <div class="scene" id="scene"></div>
      <div id="text"></div>
      <div id="adv"></div>
      <div class="choices" id="choices"></div>
      <div class="toolbar">
        <button class="ghost" id="btn-back" title="Retour (‚Üê)">‚Üê Retour</button>
        <button class="primary" id="btn-next" title="Suivant (‚Üí)">Suivant ‚Üí</button>
      </div>
      <div class="journal" id="journal"></div>
    </main>

    <div class="footer">
      <div>Raccourcis : <span class="kbd">‚Üê</span> <span class="kbd">‚Üí</span> naviguer ‚Ä¢ <span class="kbd">R</span> recommencer</div>
      <div id="footer"></div>
    </div>
  </div>

  <!-- üîó Import du contenu narratif -->
  <script src="data.js"></script>

  <!-- üîß Script principal du moteur de jeu -->
  <script>
    window.addEventListener("DOMContentLoaded", () => {
      const state = {
        current: "A1_S1",
        history: [],
        journal: [],
        flags: {}
      };

      const els = {
        act: document.getElementById("act"),
        scene: document.getElementById("scene"),
        text: document.getElementById("text"),
        adv: document.getElementById("adv"),
        choices: document.getElementById("choices"),
        journal: document.getElementById("journal"),
        tone: document.getElementById("pill-tone"),
        actpill: document.getElementById("pill-act")
      };

      function render(id) {
        const s = MemoireDeCendre[id];
        if (!s) return;
        state.current = id;
        state.history.push(id);

        els.act.textContent = "Acte " + s.act;
        els.scene.textContent = s.title || "";
        els.text.textContent = s.text || "";
        els.adv.textContent = s.adv || "";
        els.tone.textContent = "Tonalit√© : " + (s.tone || "‚Äî");
        els.actpill.textContent = "Acte " + s.act;

        els.choices.innerHTML = "";
        (s.choices || []).forEach(c => {
          const b = document.createElement("button");
          b.textContent = c.label;
          b.onclick = () => {
            if (c.log) state.journal.push("‚Üí " + c.log);
            if (c.flag) state.flags[c.flag] = true;
            render(c.next);
          };
          els.choices.appendChild(b);
        });

        els.journal.textContent = state.journal.slice(-3).join("\n");
      }

      document.getElementById("btn-restart").onclick = () => {
        state.current = "A1_S1";
        state.history = [];
        state.journal = [];
        render("A1_S1");
      };

      document.getElementById("btn-next").onclick = () => {
        const s = MemoireDeCendre[state.current];
        if (s && s.choices && s.choices.length > 0) render(s.choices[0].next);
      };

      document.getElementById("btn-back").onclick = () => {
        if (state.history.length > 1) {
          state.history.pop();
          render(state.history.pop());
        }
      };

      render("A1_S1");
    });
  </script>
</body>
</html>
